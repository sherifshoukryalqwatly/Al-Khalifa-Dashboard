<div class="d-flex justify-content-between align-items-center mb-4 flex-wrap">
  <div>
    <h4 class="fw-bold mb-1">Order Edit</h4>
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a routerLink="/orders">Orders</a></li>
        <li class="breadcrumb-item active">Edit</li>
      </ol>
    </nav>
  </div>
</div>

@if (!loading) {
  <form class="row justify-content-center" [formGroup]="form" (ngSubmit)="updateOrder()">

    <div class="col-lg-6">
      <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap">
        <h4 class="fw-bold pe-2">Edit Order</h4>
        <button class="btn btn-primary" type="submit">Save Changes</button>
      </div>

      <div class="row">
        <div class="col-md-6">
          <label>Status</label>
          <select formControlName="status" class="form-select">
            <option value="pending">Pending</option>
            <option value="processing">Processing</option>
            <option value="shipped">Shipped</option>
            <option value="completed">Completed</option>
            <option value="cancelled">Cancelled</option>
          </select>
        </div>

        <div class="col-md-6">
          <label>Payment Method</label>
          <input class="form-control" formControlName="paymentMethod">
        </div>
      </div>

      <hr>

      <h6 class="fw-bold">Items</h6>

      <table class="table">
        <thead>
          <tr>
            <th>Product</th>
            <th>Price</th>
            <th class="text-center">Qty</th>
            <th class="text-end">Total</th>
          </tr>
        </thead>
        <tbody formArrayName="items">
          @for (item of items.controls; track $index; let i = $index) {
            <tr [formGroupName]="i">
              <td>{{ item.value.name }}</td>
              <td>{{ item.value.price }} EGP</td>
              <td class="text-center">
                <input type="number"
                       min="1"
                       class="form-control w-50 mx-auto"
                       formControlName="quantity">
              </td>
              <td class="text-end">
                {{ item.value.price * item.value.quantity }} EGP
              </td>
            </tr>
          }
        </tbody>
      </table>

      <div class="text-end fw-bold">
        Subtotal: {{ subtotal }} EGP
      </div>

    </div>
  </form>
}
